br_je_plc_succession = {
    icon = "gfx/interface/icons/event_icons/event_military.dds"

	group = je_group_internal_affairs

    scripted_progress_bar = br_plc_sucession_reform_progress_bar

    modifiers_while_active = {
    }

    is_shown_in_lobby = {
		c:PLC ?= this
	}

    immediate = {
        ruler = {
            set_character_immortal = yes
        }
        br_calc_given_ig_clout = {
            ig = ig:ig_intelligentsia
            result_var = br_plc_succession_intelligentsia_clout_var
        }

        #Update reform support var's
        #because the je scope can't be scoped to directly in the immediate block
        br_plc_succession_update_reform_support_vars_when_je_scope_not_init = yes
    }

    on_monthly_pulse = {
        effect = {
            br_calc_given_ig_clout = {
                ig = ig:ig_intelligentsia
                result_var = br_plc_succession_intelligentsia_clout_var
            }

            #Update reform support var's
            br_plc_succession_update_reform_support_vars = yes
        }
    }

    timeout = 1825

    on_timeout = {
        ruler = {
            kill_character = yes
        }
        br_plc_succession_add_reform_support_modifier = yes
        trigger_event = {
            id = br_plc_succession_events.1
            popup = yes
        }
        add_journal_entry = {
            type = br_je_plc_reform_main
        }
        br_plc_reform_variable_cleanup_scripted_effect = yes
	}

    weight = 100
	should_be_pinned_by_default = yes
}

je_eastern_resistance = {
    icon = "gfx/interface/icons/event_icons/event_military.dds"
    
	group = je_group_internal_affairs

    modifiers_while_active = {
        br_modifier_eastern_oppression
    }

    is_shown_in_lobby = {
		c:PLC ?= this
	}
	
    is_shown_when_inactive = {
        exists = c:PLC
        c:PLC = root
    }

    possible = {
        exists = c:PLC
        c:PLC = root
        owns_entire_state_region = STATE_KIEV
    }

    complete = { 
        NOT = { 
            has_law_or_variant = law_type:law_serfdom
        }
        NOT = {  country_has_primary_culture = cu:ukrainian }
    }  

    fail = {
        any_country = { 	
            is_secessionist = yes
            is_diplomatic_play_target = yes
            OR = {
                country_has_primary_culture = cu:ukrainian
            }
        }
    }

    on_fail = {
        trigger_event = {
            id = poland.5
            days = 21
        }
    }

    on_complete = {
        trigger_event = {
            id = poland.6
        }
    }

    weight = 100
	should_be_pinned_by_default = yes
}

#########################################################################################################################
###
### PLC reform JE's
###
#########################################################################################################################
#Two Reform Paths with associated reform journals for it based on the “Tanzimat” reforms of base game Ottoman Empire
#A Jadwigan reforms route vs a modarate reforms route
br_je_plc_reform_main = {
    icon = "gfx/interface/icons/event_icons/event_military.dds"

	group = je_group_internal_affairs

    scripted_progress_bar = br_je_plc_reform_main_progress_bar

	is_shown_in_lobby = {
		c:PLC ?= THIS
    }

    immediate = {
        #set variables
        set_variable = {
			name = br_plc_reform_total_nr_of_completed_je_var
			value = 0
		}
        set_variable = {
			name = br_plc_reform_nr_of_completed_jadwigan_reform_je_var
			value = 0
		}
        set_variable = {
			name = br_plc_reform_nr_of_completed_moderate_reform_je_var
			value = 0
		}

        #Add sub journals
        add_journal_entry = {
            type = br_je_plc_jadwigan_reform_1
        }
        add_journal_entry = {
            type = br_je_plc_jadwigan_reform_2
        }
        add_journal_entry = {
            type = br_je_plc_jadwigan_reform_3
        }
        add_journal_entry = {
            type = br_je_plc_jadwigan_reform_4
        }
        add_journal_entry = {
            type = br_je_plc_jadwigan_reform_5
        }
    }

    custom_completion_header = br_je_plc_reform_main_completion_header

	complete = {
		br_plc_reform_has_completed_all_jadwigan_reforms = yes
	}

	on_complete = {
		add_modifier = br_modifier_plc_reform_jadwigan_reforms
        ruler = {
            add_trait = br_succesful_reformer
        }
	}

    custom_failure_header = br_je_plc_reform_main_failure_header

    fail = {
        br_plc_reform_has_completed_all_moderate_reforms = yes
    }

    on_fail = {
        add_modifier = br_modifier_plc_reform_moderate_reforms
        ruler = {
            add_trait = br_succesful_compromiser
        }
    }

	timeout = br_je_plc_reform_main_timeout

	on_timeout = {
	}

	weight = 10000

	should_be_pinned_by_default = yes
}

###
### Jadwigan reforms JE
###

#Jadwigan Reforms: Memories of the Slavic Slave Trade
br_je_plc_jadwigan_reform_1 = {
    icon = "gfx/interface/icons/event_icons/event_military.dds"

	group = je_group_internal_affairs

	# is_shown_in_lobby = {}    #shoudn't be shown in lobby

    immediate = {
    }

	complete = {
		has_law_or_variant = law_type:law_homesteading
	}

	on_complete = {
        br_plc_reform_increase_jadwigan_progress = yes
		remove_modifier = br_modifier_the_issue_of_serfdom
        add_modifier = br_modifier_plc_reform_jadwigan_land_reforms
	}

    fail = {
        not = {
            has_journal_entry = br_je_plc_reform_main
        }
    }

	timeout = br_je_plc_reform_main_timeout

	on_timeout = {
	}

	weight = 5000
}

#Jadwigan Reforms: Improving the Golden Liberty
br_je_plc_jadwigan_reform_2 = {
    icon = "gfx/interface/icons/event_icons/event_military.dds"

	group = je_group_internal_affairs

	# is_shown_in_lobby = {}    #shoudn't be shown in lobby

    immediate = {
    }

	complete = {
		has_law_or_variant = law_type:law_census_voting
        or = {
            has_law_or_variant = law_type:law_appointed_bureaucrats
            has_law_or_variant = law_type:law_elected_bureaucrats
        }
	}

	on_complete = {
        br_plc_reform_increase_jadwigan_progress = yes
		remove_modifier = br_modifier_liberum_veto
        add_modifier = br_modifier_plc_reform_jadwigan_liberties
	}

    fail = {
        not = {
            has_journal_entry = br_je_plc_reform_main
        }
    }

	timeout = br_je_plc_reform_main_timeout

	on_timeout = {
	}

	weight = 5000
}

#Jadwigan Reforms: The Minorities of the Commonwealth
br_je_plc_jadwigan_reform_3 = {
    icon = "gfx/interface/icons/event_icons/event_military.dds"

	group = je_group_internal_affairs

    scripted_button = br_je_add_lithuanian_as_primary_culture_button
    scripted_button = br_je_add_ukrainian_as_primary_culture_button
    scripted_button = br_je_negotiate_with_the_cossacks_button

	# is_shown_in_lobby = {}    #shoudn't be shown in lobby

    immediate = {
    }

	complete = {
		has_law_or_variant = law_type:law_total_separation
        not = {
            or = {
                has_law_or_variant = law_type:law_ethnostate
                has_law_or_variant = law_type:law_national_supremacy
            }
        }
        country_has_primary_culture = cu:lithuanian
        country_has_primary_culture = cu:ukrainian
	}

	on_complete = {
        br_plc_reform_increase_jadwigan_progress = yes
		remove_modifier = br_modifier_eastern_oppression
        add_modifier = br_modifier_plc_reform_restored_warsaw_confederation
	}

    fail = {
        not = {
            has_journal_entry = br_je_plc_reform_main
        }
    }

	timeout = br_je_plc_reform_main_timeout

	on_timeout = {
	}

	weight = 5000
}

#Jadwigan Reforms: A New Economic Model
br_je_plc_jadwigan_reform_4 = {
    icon = "gfx/interface/icons/event_icons/event_military.dds"

	group = je_group_internal_affairs

	# is_shown_in_lobby = {}    #shoudn't be shown in lobby

    immediate = {
    }

	complete = {
		has_law_or_variant = law_type:law_interventionism
	}

	on_complete = {
        br_plc_reform_increase_jadwigan_progress = yes
		remove_modifier = br_modifier_piotrkow_statutes
        add_modifier = br_modifier_plc_reform_jadwigan_economy
	}

    fail = {
        has_law_or_variant = law_type:law_laissez_faire
    }

    on_fail = {
        br_plc_reform_increase_jadwigan_progress = yes
		remove_modifier = br_modifier_piotrkow_statutes
        add_modifier = br_modifier_plc_reform_hands_off_economy
    }

    invalid = {
        not = {
            has_journal_entry = br_je_plc_reform_main
        }
    }

	timeout = br_je_plc_reform_main_timeout

	on_timeout = {
	}

	weight = 5000
}

#Jadwigan Reforms: Military Reformation
br_je_plc_jadwigan_reform_5 = {
    icon = "gfx/interface/icons/event_icons/event_military.dds"

	group = je_group_internal_affairs

	# is_shown_in_lobby = {}    #shoudn't be shown in lobby

    immediate = {
    }

	complete = {
		has_law_or_variant = law_type:law_professional_army
	}

	on_complete = {
        br_plc_reform_increase_jadwigan_progress = yes
		remove_modifier = br_modifier_plc_army
        add_modifier = br_modifier_plc_reform_grand_army_of_the_commonwealth
	}

    fail = {
        has_law_or_variant = law_type:law_national_militia
    }

    on_fail = {
        br_plc_reform_increase_jadwigan_progress = yes
		remove_modifier = br_modifier_plc_army
        add_modifier = br_modifier_plc_reform_commonwealther_home_army
    }

    invalid = {
        not = {
            has_journal_entry = br_je_plc_reform_main
        }
    }

	timeout = br_je_plc_reform_main_timeout

	on_timeout = {
	}

	weight = 5000
}